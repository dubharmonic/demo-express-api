users = [
    id: 1
    'firstName': 'Yasir'
    'lastName': 'Wolfe'
    'country': 'El Salvador'
    'phone': '1-676-572-4675'
    'city': 'Schenebeck'
  ,
    id: 2
    'firstName': 'Melanie'
    'lastName': 'Phelps'
    'country': 'Sri Lanka'
    'phone': '1-266-780-0024'
    'city': 'Nazilli'
  ,
    id: 3
    'firstName': 'Ayanna'
    'lastName': 'Mcfarland'
    'country': 'Cambodia'
    'phone': '1-818-821-0235'
    'city': 'ViranÅŸehir'
  ,
    id: 4
    'firstName': 'Maya'
    'lastName': 'Wilkinson'
    'country': 'Moldova'
    'phone': '1-196-143-2132'
    'city': 'Burlington'
  ,
    id: 5
    'firstName': 'Burke'
    'lastName': 'Cunningham'
    'country': 'Heard Island'
    'phone': '1-154-395-3450'
    'city': 'Omaha'
  ,
    id: 6
    'firstName': 'Eugenia'
    'lastName': 'Gates'
    'country': 'Armenia'
    'phone': '1-654-494-9614'
    'city': 'Leerbeek'
  ,
    id: 7
    'firstName': 'Stone'
    'lastName': 'Mckenzie'
    'country': 'Serbia'
    'phone': '1-865-771-8292'
    'city': 'Mantova'
  ,
    id: 8
    'firstName': 'Declan'
    'lastName': 'White'
    'country': 'Solomon Islands'
    'phone': '1-666-196-8846'
    'city': 'Purmerend'
  ,
    id: 9
    'firstName': 'Evangeline'
    'lastName': 'Fuller'
    'country': 'El Salvador'
    'phone': '1-964-906-1918'
    'city': 'Joliet'
  ,
    id: 10
    'firstName': 'Basia'
    'lastName': 'Stein'
    'country': 'Latvia'
    'phone': '1-424-614-1397'
    'city': 'Manukau'
  ,
    id: 11
    'firstName': 'Florence'
    'lastName': 'Phillips'
    'country': 'Poland'
    'phone': '1-396-909-7915'
    'city': 'Saint-Servais'
  ,
    id: 12
    'firstName': 'Yoshi'
    'lastName': 'Rowe'
    'country': 'Angola'
    'phone': '1-346-634-8555'
    'city': 'Oyen'
  ,
    id: 13
    'firstName': 'Hall'
    'lastName': 'Dixon'
    'country': 'Antarctica'
    'phone': '1-308-700-5612'
    'city': 'Parramatta'
  ,
    id: 14
    'firstName': 'Emmanuel'
    'lastName': 'Fitzpatrick'
    'country': 'Netherlands'
    'phone': '1-891-609-8084'
    'city': 'Fernie'
  ,
    id: 15
    'firstName': 'Tatiana'
    'lastName': 'Pierce'
    'country': 'Korea, North'
    'phone': '1-283-676-7486'
    'city': 'Pontedera'
  ,
    id: 16
    'firstName': 'Regina'
    'lastName': 'Tran'
    'country': 'Maldives'
    'phone': '1-418-346-1386'
    'city': 'Horsham'
  ,
    id: 17
    'firstName': 'Castor'
    'lastName': 'Dean'
    'country': 'Guatemala'
    'phone': '1-424-364-9318'
    'city': 'Haldia'
  ,
    id: 18
    'firstName': 'Kenneth'
    'lastName': 'Walker'
    'country': 'Myanmar'
    'phone': '1-206-176-2293'
    'city': 'Kota'
  ,
    id: 19
    'firstName': 'Keelie'
    'lastName': 'Bell'
    'country': 'Taiwan'
    'phone': '1-541-868-3972'
    'city': 'Tourinnes-la-Grosse'
  ,
    id: 20
    'firstName': 'Cooper'
    'lastName': 'Gates'
    'country': 'Miquelon'
    'phone': '1-616-733-4934'
    'city': 'Pozzuolo del Friuli'
  ,
    id: 21
    'firstName': 'Maris'
    'lastName': 'Copeland'
    'country': 'Anguilla'
    'phone': '1-512-719-2919'
    'city': 'Rutland'
  ,
    id: 22
    'firstName': 'Sylvia'
    'lastName': 'Ewing'
    'country': 'Taiwan'
    'phone': '1-362-377-8698'
    'city': 'Batiscan'
  ,
    id: 23
    'firstName': 'Isaiah'
    'lastName': 'Daniels'
    'country': 'Niger'
    'phone': '1-650-533-6481'
    'city': 'Montoggio'
  ,
    id: 24
    'firstName': 'Eaton'
    'lastName': 'Montgomery'
    'country': 'Iran'
    'phone': '1-497-357-3412'
    'city': 'Villafranca'
  ,
    id: 25
    'firstName': 'Emmanuel'
    'lastName': 'Greene'
    'country': 'Rwanda'
    'phone': '1-124-300-3262'
    'city': 'Reno'
  ,
    id: 26
    'firstName': 'Karina'
    'lastName': 'Rose'
    'country': 'Guinea-Bissau'
    'phone': '1-951-617-9574'
    'city': 'Chartres'
  ,
    id: 27
    'firstName': 'Halee'
    'lastName': 'Guerra'
    'country': 'Papua New Guinea'
    'phone': '1-304-590-6650'
    'city': 'Perth'
  ,
    id: 28
    'firstName': 'Emerson'
    'lastName': 'Wooten'
    'country': 'Afghanistan'
    'phone': '1-129-974-9269'
    'city': 'Solingen'
  ,
    id: 29
    'firstName': 'Griffin'
    'lastName': 'Valenzuela'
    'country': 'American Samoa'
    'phone': '1-367-384-7238'
    'city': 'Meer'
  ,
    id: 30
    'firstName': 'Honorato'
    'lastName': 'Daniel'
    'country': 'Saint BarthÃ©lemy'
    'phone': '1-349-194-9691'
    'city': 'Westmeerbeek'
  ,
    id: 31
    'firstName': 'Basia'
    'lastName': 'Everett'
    'country': 'Cocos Islands'
    'phone': '1-126-452-8023'
    'city': 'Tourinne'
  ,
    id: 32
    'firstName': 'Palmer'
    'lastName': 'Sherman'
    'country': 'Saint Kitts'
    'phone': '1-160-521-1986'
    'city': 'Spokane'
  ,
    id: 33
    'firstName': 'Ginger'
    'lastName': 'Koch'
    'country': 'Vanuatu'
    'phone': '1-160-357-2762'
    'city': 'Copertino'
  ,
    id: 34
    'firstName': 'Boris'
    'lastName': 'Daugherty'
    'country': 'Philippines'
    'phone': '1-540-715-4647'
    'city': 'Malives'
  ,
    id: 35
    'firstName': 'Idona'
    'lastName': 'Dixon'
    'country': 'Morocco'
    'phone': '1-420-920-5237'
    'city': 'Yorkton'
  ,
    id: 36
    'firstName': 'Veronica'
    'lastName': 'Nielsen'
    'country': 'Azerbaijan'
    'phone': '1-749-523-9272'
    'city': 'Chiusa/Klausen'
  ,
    id: 37
    'firstName': 'Shannon'
    'lastName': 'Spears'
    'country': 'Guinea-Bissau'
    'phone': '1-215-602-2705'
    'city': 'Castiglione a Casauria'
  ,
    id: 38
    'firstName': 'Halee'
    'lastName': 'Parrish'
    'country': 'Oman'
    'phone': '1-664-912-1037'
    'city': 'Pinkafeld'
  ,
    id: 39
    'firstName': 'Glenna'
    'lastName': 'Wallace'
    'country': 'Mayotte'
    'phone': '1-754-411-7651'
    'city': 'Watson Lake'
  ,
    id: 40
    'firstName': 'Dominic'
    'lastName': 'Watts'
    'country': 'Timor-Leste'
    'phone': '1-693-673-9223'
    'city': 'Cedar Rapids'
  ,
    id: 41
    'firstName': 'Xantha'
    'lastName': 'Walton'
    'country': 'Albania'
    'phone': '1-492-156-8156'
    'city': 'Morhet'
  ,
    id: 42
    'firstName': 'Oscar'
    'lastName': 'Blake'
    'country': 'Samoa'
    'phone': '1-440-292-2665'
    'city': 'Price'
  ,
    id: 43
    'firstName': 'Suki'
    'lastName': 'Rosa'
    'country': 'Ireland'
    'phone': '1-608-107-5826'
    'city': 'Pozzuolo del Friuli'
  ,
    id: 44
    'firstName': 'Wylie'
    'lastName': 'Odonnell'
    'country': 'Kuwait'
    'phone': '1-590-235-3450'
    'city': 'Duluth'
  ,
    id: 45
    'firstName': 'Marvin'
    'lastName': 'Johnston'
    'country': 'Sweden'
    'phone': '1-332-521-1126'
    'city': 'Dusseldorf'
  ,
    id: 46
    'firstName': 'Tasha'
    'lastName': 'Hartman'
    'country': 'Turkey'
    'phone': '1-967-215-7979'
    'city': 'Milano'
  ,
    id: 47
    'firstName': 'Chelsea'
    'lastName': 'Reynolds'
    'country': 'Maldives'
    'phone': '1-316-774-9954'
    'city': 'Guysborough'
  ,
    id: 48
    'firstName': 'Henry'
    'lastName': 'Gonzales'
    'country': 'New Caledonia'
    'phone': '1-523-538-6046'
    'city': 'Oklahoma City'
  ,
    id: 49
    'firstName': 'Bethany'
    'lastName': 'Howe'
    'country': 'Taiwan'
    'phone': '1-457-512-1695'
    'city': 'Baden-Baden'
]

idCounter = 50

express = require 'express'
bodyParser = require 'body-parser'
_ = require 'lodash'

app = express()
app.use bodyParser.json()

# middleware that will add the Access-Control-Allow-Origin header to everything
app.use (req, res, next) ->
  res.set 'Access-Control-Allow-Origin', '*'
  next()

# set these headers on all of the OPTIONS preflight responses
app.options '*', (req, res) ->
  res.set 'Access-Control-Allow-Headers', 'accept, content-type'
  res.set 'Access-Control-Allow-Methods', 'GET, PUT, POST, DELETE, OPTIONS, PATCH'
  res.send()

# Get all
app.get '/users', (req, res) ->
  res.send users

# Get one
app.get '/users/:userId', (req, res) ->
  res.send _.find users, id: parseInt req.params.userId

# Update
app.put '/users/:userId', (req, res) ->
  users[_.findIndex users, id: parseInt req.params.userId] = req.body
  res.sendStatus 204

# New
app.post '/users', (req, res) ->
  # new objects need IDs
  req.body.id = idCounter++
  # add to the collection
  users.push req.body
  res.status(201).send req.body

# Delete
app.delete '/users/:userId', (req, res) ->
  _.remove users, id: parseInt req.params.userId
  res.sendStatus 204

app.listen 9002
